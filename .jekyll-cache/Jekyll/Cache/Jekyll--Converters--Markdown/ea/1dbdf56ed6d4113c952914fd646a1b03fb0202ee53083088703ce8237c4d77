I"ñT<p>PrzyszÅ‚a Å›roda, a wiÄ™c czas na pierwszy zbiÃ³r przykÅ‚adÃ³w. Zaczniemy najproÅ›ciej jak to moÅ¼liwe. Wygenerujemy kilka syntetycznych zbiorÃ³w danych, zapisujÄ…c je pÃ³Åºniej do plikÃ³w CSV.</p>

<!--more-->

<h2 id="syntetyczne-zbiory-danych">Syntetyczne zbiory danych</h2>

<p>Co do zasady jest tak, Å¼e w prawdziwych badaniach naukowych (takich powaÅ¼nych, ktÃ³re podobno bÄ™dzie ktoÅ› czytaÄ‡) nie powinniÅ›my raczej korzystaÄ‡Â ze zbiorÃ³w syntetycznych â€“ tj. wygenerowanych przez algorytm prÃ³b wzorcÃ³w, ktÃ³re nie przedstawiajÄ… Å¼adnego prawdziwego problemu.</p>

<p>Mimo tego, okazujÄ…Â siÄ™ bardzo przydatne. PozwalajÄ… nam Å‚atwo i szybko uzyskaÄ‡ wiele jednoczeÅ›nie rÃ³Å¼nych i powtarzalnych (kochajmy <code class="highlighter-rouge">random_state</code>) prÃ³b problemu, ktÃ³re speÅ‚niajÄ… postawione przez nas wymagania. PrzykÅ‚adowo, moÅ¼emy wygenerowaÄ‡ na raz dziesiÄ™Ä‡ rÃ³Å¼niÄ…cych siÄ™Â od siebie zbiorÃ³w danych, z ktÃ³rych kaÅ¼dy bÄ™dzie mieÄ‡Â dokÅ‚adnie trzydzieÅ›ci obiektÃ³w (maÅ‚a liczba wzorcÃ³w) majÄ…cych po tysiÄ…c atrybutÃ³w (wysoka wymiarowoÅ›Ä‡ problemu).</p>

<p>DuÅ¼a czÄ™Å›Ä‡ pracy badawczej, szczegÃ³lnie na poczÄ…tku kaÅ¼dych badaÅ„, to budowanie prototypÃ³w â€“ pierwszych podejÅ›Ä‡ do problemÃ³w, ktÃ³re powinniÅ›my byÄ‡ w stanie szybko przetestowaÄ‡, Å¼eby wczeÅ›nie wyÅ‚apaÄ‡ bÅ‚Ä™dy programistyczne i koncepcyjne wymyÅ›lonej przez nas metody. DziÄ™ki temu znacznie szybciej uda siÄ™ przejÅ›Ä‡Â z etapu prototypowania do konstrukcji gotowego juÅ¼ algorytmu, ktÃ³ry oczywiÅ›cie na koniec przetestujemy juÅ¼ na zbiorach rzeczywistych.</p>

<h3 id="generowanie-zbiorÃ³w-syntetycznych">Generowanie zbiorÃ³w syntetycznych</h3>

<p>DosyÄ‡ przekonywania, Å¼e to przydatne, przejdÅºmy do przykÅ‚adu.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">datasets</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">datasets</span><span class="o">.</span><span class="n">make_classification</span><span class="p">()</span>
</code></pre></div></div>

<p>W pierwszej linijce przykÅ‚adu, z biblioteki <a href="https://scikit-learn.org/stable/">scikit-learn</a> importujemy moduÅ‚ <a href="https://scikit-learn.org/stable/datasets/index.html">datasets</a>, odpowiadajÄ…cy m.in. za wczytywanie kilku standardowych zbiorÃ³w danych (niektÃ³re majÄ… po sto lat, wiÄ™c przez jakiÅ›Â czas nie bÄ™dziemy siÄ™ nimi raczej przejmowaÄ‡) i wÅ‚aÅ›nie za generowanie zbiorÃ³w syntetycznych. SÅ‚uÅ¼y do tego funkcja <a href="https://scikit-learn.org/stable/modules/generated/sklearn.datasets.make_classification.html"><code class="highlighter-rouge">make_classification()</code></a>, ktÃ³rÄ… wywoÅ‚aliÅ›my na koÅ„cu tego krÃ³tkiego przykÅ‚adu. Zwraca ona krotkÄ™ <code class="highlighter-rouge">(X, y)</code>, ktÃ³rej pierwszy element to â€“ zgodnie z oznaczeniami, ktÃ³re juÅ¼ raczej znamy â€“ <em>zbiÃ³r danych</em>, a drugi jest <em>zbiorem etykiet</em>. Podejrzyjmy jakiej wielkoÅ›ci struktury sÄ… generowane przez niÄ…Â domyÅ›lnie</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">print</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</code></pre></div></div>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&gt;&gt; (100, 20) (100,)
</code></pre></div></div>

<p>W zbiorze danych (macierz <code class="highlighter-rouge">X</code>) znajduje siÄ™Â sto wierszy po dwadzieÅ›cia elementÃ³w. Oznacza to, Å¼e wygenerowaliÅ›my sto wzorcÃ³w, kaÅ¼dy po dwadzieÅ›cia atrybutÃ³w. W zbiorze etykiet znajdujÄ…Â siÄ™ (szokujÄ…ce) etykiety dla kaÅ¼dego ze wzorcÃ³w.</p>

<h3 id="argumenty-funkcji-make_classification">Argumenty funkcji <code class="highlighter-rouge">make_classification()</code></h3>

<p>OczywiÅ›cie, kaÅ¼dy z tych parametrÃ³w moÅ¼emy kontrolowaÄ‡. PrzykÅ‚adowo, wygenerujmy zbiÃ³r danych zawierajÄ…cy tysiÄ…c oÅ›miowymiarowych wzorcÃ³w.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">datasets</span><span class="o">.</span><span class="n">make_classification</span><span class="p">(</span><span class="n">n_samples</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">n_features</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</code></pre></div></div>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&gt;&gt; (1000, 8) (1000,)
</code></pre></div></div>

<p>Kolejne parametry (<code class="highlighter-rouge">n_samples</code>, <code class="highlighter-rouge">n_features</code>) przekazujemy jako argumenty funkcji. Zaimplementowana w niej metoda (oryginalnie sÅ‚uÅ¼Ä…ca do generowania <a href="http://clopinet.com/isabelle/Projects/NIPS2003/Slides/NIPS2003-Datasets.pdf">zbioru Madelon</a>  i opracowana w 2003. roku przez PaniÄ… <a href="http://clopinet.com/isabelle/">Isabelle Guyon</a>) przyjmuje wiele argumentÃ³w, ale wymienimy sobie z nich tylko te, ktÃ³re okaÅ¼Ä… nam siÄ™Â najbardziej przydatne w eksperymentach na potrzeby laboratorium i projektu (jeÅ›li kiedykolwiek jeszcze siÄ™Â na nich spotkamy):</p>

<ul>
  <li><code class="highlighter-rouge">n_samples</code> â€” liczba generowanych wzorcÃ³w (domyÅ›lnie 100).</li>
  <li><code class="highlighter-rouge">n_features</code> â€” liczba atrybutÃ³w zbioru (domyÅ›lnie 20).</li>
  <li><code class="highlighter-rouge">n_classes</code> â€” liczba klas problemu (domyÅ›lnie 2, a wiÄ™c problem binarny).</li>
  <li><code class="highlighter-rouge">n_clusters_per_class</code> â€” liczba centroidÃ³w dla kaÅ¼dej klasy, a wiÄ™c liczba skupisk kaÅ¼dej z klas problemu (domyÅ›lnie 2).</li>
  <li><code class="highlighter-rouge">flip_y</code> â€” poziom szumu, a wiÄ™c liczba etykiet, ktÃ³re celowo majÄ… posiadaÄ‡ bÅ‚Ä™dne przypisanie (domyÅ›lnie 0.01).</li>
  <li><code class="highlighter-rouge">random_state</code> â€” ziarno losowoÅ›ci, ktÃ³re pozwala na wygenerowanie dokÅ‚adnie tego samego zbioru w kaÅ¼dym powtÃ³rzeniu skryptu (domyÅ›lnie None, czyli losowe ziarno losowoÅ›ci).</li>
</ul>

<p>Poza tymi podstawowymi wÅ‚asnoÅ›ciami zbioru danych, na poczÄ…tek warto jeszcze dowiedzieÄ‡Â siÄ™Â jak sterowaÄ‡ rodzajami generowanych atrybutÃ³w. W wypadku tego generatora wszystkie cechy bÄ™dÄ… iloÅ›ciowymi, ale moÅ¼emy modyfikowaÄ‡ charakterystykÄ™ ich przydatnoÅ›ci w budowie modelu. Istotne argumenty w tym wypadku to:</p>

<ul>
  <li><code class="highlighter-rouge">n_informative</code> â€” liczba atrybutÃ³w informatywnych, a wiÄ™c tych, ktÃ³re faktycznie zawierajÄ… informacje przydatne dla klasyfikacji, a nie jedynie szum (domyÅ›lnie 2).</li>
  <li><code class="highlighter-rouge">n_redundant</code> â€” liczba atrybutÃ³w nadmiarowych, bÄ™dÄ…cych kombinacjami cech informatywnych (domyÅ›lnie 2).</li>
  <li><code class="highlighter-rouge">n_repeated</code> â€” liczba atrybutÃ³w powtÃ³rzonych, czyli zduplikowanych kolumn, losowo wybranych z informatywnych i redundantnych (domyÅ›lnie 2).</li>
</ul>

<p>DomyÅ›lnie zatem generowany jest niepowtarzalny (brak ziarna losowoÅ›ci) binarny problem, ktÃ³ry skÅ‚ada siÄ™ ze stu wzorcÃ³w, a jedynie szeÅ›Ä‡ z jego dwudziestu atrybutÃ³w zawiera informacje potencjalnie przydatne (dwa informatywne, dwa to kombinacje informatywnych i dwa powtarzajÄ… losowe z czterech poprzednich), a reszta skÅ‚ada siÄ™Â wyÅ‚Ä…cznie z szumu.</p>

<h3 id="wymyÅ›lamy-problem">WymyÅ›lamy problem</h3>

<p>Uzbrojeni w wiedzÄ™Â o parametrach <code class="highlighter-rouge">make_classification()</code> moÅ¼emy wymyÅ›liÄ‡ sobie problem. Niech bÄ™dzie to odtwarzalny (ziarno 1410), dwuwymiarowy zbiÃ³r danych, w ktÃ³rym jedynie jeden atrybut bÄ™dzie informatywny (w drugim znajdzie siÄ™Â szum) i skÅ‚ada siÄ™ ze stu wzorcÃ³w o poziomie szumu wynoszÄ…cym piÄ™Ä‡ procent dla problemu binarnego.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">datasets</span><span class="o">.</span><span class="n">make_classification</span><span class="p">(</span>
    <span class="n">n_samples</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
    <span class="n">n_features</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
    <span class="n">n_informative</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">n_repeated</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">n_redundant</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">flip_y</span><span class="o">=</span><span class="mf">.05</span><span class="p">,</span>
    <span class="n">random_state</span><span class="o">=</span><span class="mi">1410</span><span class="p">,</span>
    <span class="n">n_clusters_per_class</span><span class="o">=</span><span class="mi">1</span>
<span class="p">)</span>
</code></pre></div></div>

<p>Dwuwymiarowy zbiÃ³r wygenerowaliÅ›my po to, Å¼eby mÃ³c wygenerowaÄ‡ jego <em>scatterplot</em>. Kolejno, importujemy bibliotekÄ™ <code class="highlighter-rouge">matplotlib</code>, przygotowujemy pustÄ… ilustracjÄ™ o wymiarach 5 na 2.5 cala, rysujemy <em>scatterplot</em> (podajÄ…c osobno kolumny z wymiarami i okreÅ›lajÄ…c kolor â€“ <code class="highlighter-rouge">c</code> â€“ przez wygenerowane etykiety), opisujemy osi i zapisujemy plik PNG.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mf">2.5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">X</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s">'bwr'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">"$x^1$"</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">"$x^2$"</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s">'sroda1.png'</span><span class="p">)</span>
</code></pre></div></div>

<p><img src="/examples/sroda1.png" alt="" /></p>

<p>Jak widaÄ‡Â na zaÅ‚Ä…czonym obrazku, pierwszy atrybut pozwala na rozrÃ³Å¼nienie klas, a wiÄ™c jest informatywny a drugi zawiera wyÅ‚Ä…cznie szum. Dodatkowo, w obu skupiskach widaÄ‡Â pojedyncze obiekty o oryginalnie bÅ‚Ä™dnej etykiecie, w sumie skÅ‚adajÄ…ce siÄ™ na dokÅ‚adnie piÄ™Ä‡Â obiektÃ³w, a wiÄ™c piÄ™Ä‡Â procent z wygenerowanej setki obiektÃ³w.</p>

<h3 id="zapisz-Å¼eby-wczytaÄ‡pÃ³Åºniej">Zapisz, Å¼eby wczytaÄ‡Â pÃ³Åºniej</h3>
<h4 id="albo-Å¼eby-ktoÅ›-inny-mÃ³gÅ‚-to-wczytaÄ‡">Albo, Å¼eby ktoÅ› inny mÃ³gÅ‚ to wczytaÄ‡</h4>

<p>Na koniec powtÃ³rzymy sobie coÅ›, co pokazywaÅ‚em juÅ¼Â PaÅ„stwu na poczÄ…tku drugiego wykÅ‚adu. Zbiory danych bardzo czÄ™sto udostÄ™pniane sÄ… jako pliki CSV. W razie gdyby ktoÅ› nie znaÅ‚ tego formatu, sÄ…Â to <em>bardzo proste</em> pliki tekstowe reprezentujÄ…ce tablice, w ktÃ³rych kaÅ¼dy wiersz opisuje pojedynczy rekord (w naszym wypadku wzorzec), a kaÅ¼dy atrybut oddzielamy od siebie separatorem w postaci przecinka.</p>

<blockquote>
  <p>Dodatkowym wymaganiem o ktÃ³rym czÄ™sto siÄ™ zapomina jest zapewnienie w takim pliku, aby kaÅ¼dy wiersz miaÅ‚ dokÅ‚adnie tyle samo elementÃ³w (a wiÄ™c i tyle samo separatorÃ³w). OdmianÄ… tego formatu jest teÅ¼ TSV (tab-separated values), gdzie wartoÅ›ci oddzielamy znakiem tabulacji. JeÅ›li siÄ™ uprzemy, moÅ¼emy wartoÅ›ci oddzielaÄ‡ dowolnym wybranym przez nas separatorem, ale nie szarÅ¼ujmy, Å¼eby na przykÅ‚ad uÅ¼ywaÄ‡ gwiazdki czy wykrzyknika. Ani nikt tego nie zrozumie, ani na nic siÄ™ to nikomu nie przyda.</p>
</blockquote>

<p>W pierwszej kolejnoÅ›ci powinniÅ›my poÅ‚Ä…czyÄ‡ ze sobÄ… zbiÃ³r danych i zbiÃ³r etykiet, dokÅ‚adajÄ…c <code class="highlighter-rouge">y</code> jako dodatkowÄ…, ostatniÄ… kolumnÄ™ macierzy <code class="highlighter-rouge">X</code>. Uznanie zbioru etykiet za ostatniÄ… kolumnÄ™ zbioru w formie serializowanej jest czysto umowne, ale moÅ¼emy zaÅ‚oÅ¼yÄ‡, Å¼e to wygodne rozwiÄ…zanie.</p>

<p>Przyda nam siÄ™Â tutaj <code class="highlighter-rouge">numpy</code> i jej wbudowana funkcja <a href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.concatenate.html"><code class="highlighter-rouge">concatenate()</code></a>. Jak moÅ¼emy przeczytaÄ‡ w dokumentacji, jako pierwszy atrybut (nienazwany i pozycyjny) przyjmuje â€œ<em>sekwencjÄ™ lub tablicÄ™ tablic o tym samym ksztaÅ‚cie</em>â€. SekwencjÄ™Â zrozumiemy jako krotkÄ™ <code class="highlighter-rouge">(X, y)</code>, mimo, Å¼e moglibyÅ›my spokojnie przekazaÄ‡ tam takÅ¼e tablicÄ™.</p>

<p>Przekazanie jej w takiej najprostszej postaci zakoÅ„czy siÄ™ jednak bÅ‚Ä™dem wynikajÄ…cym z tego, Å¼e nie zapewniliÅ›my naszym tablicom numpy wspÃ³lnego ksztaÅ‚tu. PowinniÅ›my rozumieÄ‡Â go jako:</p>

<ul>
  <li>tÄ…Â samÄ…Â liczbÄ… wymiarÃ³w (dÅ‚ugoÅ›Ä‡ wektora zwracanÄ… przez atrybut <code class="highlighter-rouge">shape</code> tablicy),</li>
  <li>tÄ… samÄ… wielkoÅ›ciÄ… we wszystkich wymiarach poza jednym.</li>
</ul>

<p>Nasz ostatni wygenerowany zbiÃ³r danych ma wymiary <code class="highlighter-rouge">(100, 2)</code>, a zbiÃ³r etykiet <code class="highlighter-rouge">(100)</code>, a wiÄ™c nie speÅ‚niamy pierwszego z tych dwÃ³ch warunkÃ³w. MoÅ¼emy to nadrobiÄ‡ adresujÄ…c <code class="highlighter-rouge">y</code> w sposÃ³b, ktÃ³ry wygeneruje na jego koÅ„cu dodatkowy wymiar i zacznie traktowaÄ‡ nie jako wektor, a jako macierz z pojedynczÄ… kolumnÄ…. MoÅ¼emy osiÄ…gnÄ…Ä‡ to przez wywoÅ‚anie <code class="highlighter-rouge">y[:, np.newaxis]</code>.</p>

<p>Drugim niezbÄ™dnym nam atrybutem funkcji <code class="highlighter-rouge">concatenate()</code> jest <code class="highlighter-rouge">axis</code>, czyli oÅ›, w ktÃ³rej planujemy zÅ‚Ä…czyÄ‡Â ze sobÄ…Â przekazane tablice. PowinniÅ›my wskazaÄ‡Â nim w ktÃ³rym wymiarze (ktÃ³rej osi) tablice majÄ… rÃ³Å¼nÄ… wielkoÅ›Ä‡. W naszym wypadku jest to drugi parametr, wiÄ™c liczÄ…c od zera powinniÅ›my przekazaÄ‡Â tam wartoÅ›Ä‡Â <code class="highlighter-rouge">1</code>. Poprawne zÅ‚Ä…czenie moÅ¼emy zatem zapisaÄ‡Â jak poniÅ¼ej:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="n">dataset</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">[:,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div></div>

<p>PojedynczÄ… macierz moÅ¼emy juÅ¼ bez trudu zapisaÄ‡Â w pliku tekstowym o formacie CSV, znÃ³w korzystajÄ…c z metody wbudowanej <code class="highlighter-rouge">numpy</code> <a href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.savetxt.html"><code class="highlighter-rouge">savetxt()</code></a>.</p>

<p>Ma ona dwa argumenty pozycyjne. W pierwszym podajemy Å‚aÅ„cuch z nazwÄ…Â pliku, w drugim tablicÄ™, ktÃ³rÄ… chcemy zapisaÄ‡. Dodatkowo, jeÅ›li chcemy speÅ‚niÄ‡ wymagania formatu CSV, powinniÅ›my rÃ³wnieÅ¼ zmieniÄ‡ domyÅ›lny separator na przecinek.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">np</span><span class="o">.</span><span class="n">savetxt</span><span class="p">(</span><span class="s">"dataset.csv"</span><span class="p">,</span> <span class="n">dataset</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s">","</span><span class="p">)</span>
</code></pre></div></div>

<p>To niby wystarczy, ale jeÅ›li podejrzymy zawartoÅ›Ä‡ pliku, zobaczymy, Å¼e nie wyglÄ…da najpiÄ™kniej.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>-1.060890925868820389e+00,2.455805509796364028e+00,0.000000000000000000e+00
-6.853148372231210317e-01,-1.500489680108889390e+00,0.000000000000000000e+00
7.775378070067257008e-01,1.330505069088626868e+00,1.000000000000000000e+00
6.933842893245101280e-01,7.217146432694194758e-01,1.000000000000000000e+00
-2.715820952605125793e-01,7.934501868603156538e-01,1.000000000000000000e+00
</code></pre></div></div>

<p>JeÅ›li ktoÅ› jest miÅ‚oÅ›nikiem notacji naukowej, oczywiÅ›cie moÅ¼e zostawiÄ‡ to w takiej formie, ale naleÅ¼y szczerze przyznaÄ‡, Å¼e zapis etykiety, ktÃ³ra w koÅ„cu jest liczbÄ…Â caÅ‚kowitÄ… z przepastnego, dyskretnego zbioru zawierajÄ…cego jedynie zero i jedynkÄ™, jako liczbÄ™Â w notacji matematycznej z dokÅ‚adnoÅ›ciÄ… do osiemnastu miejsce po przecinku, jest cokolwiek karkoÅ‚omne. MoÅ¼emy naprawiÄ‡ to przez rÄ™czne podanie formatu liczb. Nie bÄ™dÄ™Â tego dokÅ‚adnie teraz wyjaÅ›niaÄ‡, ale proszÄ™ uwierzyÄ‡, dziaÅ‚a.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>np.savetxt(
    "dataset.csv",
    dataset,
    delimiter=",",
    fmt=["%.5f" for i in range(X.shape[1])] + ["%i"],
)
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>-1.06089,2.45581,0
-0.68531,-1.50049,0
0.77754,1.33051,1
0.69338,0.72171,1
-0.27158,0.79345,1
</code></pre></div></div>

<p>Od razu lepiej, prawda? No dobrze, to na koniec zobaczmy, jak wczytywaÄ‡ pliki CSV do tablic <code class="highlighter-rouge">numpy</code>. ZnÃ³w, mamy od tego funkcjÄ™ wbudowanÄ…, nazywanÄ… <a href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.genfromtxt.html"><code class="highlighter-rouge">genfromtxt()</code></a>. Wczytajmy zatem plik do zmiennej <code class="highlighter-rouge">dataset</code> (pamiÄ™tajÄ…c o separatorze) i spÃ³jrzmy jak piÄ™knie siÄ™ wczytaÅ‚.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">dataset</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">genfromtxt</span><span class="p">(</span><span class="s">"dataset.csv"</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s">","</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">dataset</span><span class="p">)</span>
</code></pre></div></div>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&gt;&gt; [[-1.06089  2.45581  0.     ]
&gt;&gt;  [-0.68531 -1.50049  0.     ]
&gt;&gt;  [ 0.77754  1.33051  1.     ]
&gt;&gt;  [ 0.69338  0.72171  1.     ]
&gt;&gt;  [-0.27158  0.79345  1.     ]
...
</code></pre></div></div>

<p>Skoro juÅ¼ siÄ™ wczytaÅ‚, to podzielmy go jeszcze na <code class="highlighter-rouge">X</code> i <code class="highlighter-rouge">y</code>, do pierwszego przypisujÄ…c wszystkie kolumny poza ostaniÄ…, a do drugiego jedynie ostatniÄ…. Skoro etykiety sÄ… i tak liczbami caÅ‚kowitymi, zrzutujmy jÄ…Â przy okazji na caÅ‚kowitÄ….</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">X</span> <span class="o">=</span> <span class="n">dataset</span><span class="p">[:,</span> <span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">dataset</span><span class="p">[:,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
</code></pre></div></div>

<p>PiÄ™knie. Potrafimy juÅ¼ zrealizowaÄ‡Â tak zaawansowane zadania jak wymyÅ›lenie problemu i zapisanie go na pÃ³Åºniej, Å¼eby zawsze mÃ³c do niego wrÃ³ciÄ‡. Wybornie.</p>

<p>Do przeczytania w piÄ…tek!</p>
:ET